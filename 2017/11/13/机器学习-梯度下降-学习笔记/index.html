<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="GJW的个人博客"><title>机器学习-梯度下降 学习笔记 | Reveal The Essence.</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">机器学习-梯度下降 学习笔记</h1><a id="logo" href="/.">Reveal The Essence.</a><p class="description">保持信心, 正视自己, 持续努力.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">机器学习-梯度下降 学习笔记</h1><div class="post-meta">Nov 13, 2017<span> | </span><span class="category"><a href="/categories/机器学习/">机器学习</a></span></div><div class="post-content"><h3 id="高数"><a href="#高数" class="headerlink" title="高数"></a>高数</h3><ol>
<li>导数定义 函数某一点的变化率 det(y)/det(x)</li>
<li>微分定义 当x增加时，y会相应增加，使用微分近似的表示增加的值（即保留主要值，忽略误差值）</li>
<li>积分定义 任意x属于I，存在F(x)’=f(x)，则称F(x)是f(x)的原函数。全体原函数称为不定积分。sf(x)dx=F(x)</li>
<li>偏导数 某一点对于某个变量的变化率</li>
</ol>
<p>监督学习所想要解决的问题：<br>使用已有的数据集进行训练，获取一个函数对数据集外的数据进行预测。</p>
<h4 id="评判标准"><a href="#评判标准" class="headerlink" title="评判标准"></a>评判标准</h4><p>函数预测值与真实值之间的误差总和最小，那么就认为这个函数和实际的函数越拟合。使用cost function计算误差之和。</p>
<h4 id="所用公式"><a href="#所用公式" class="headerlink" title="所用公式"></a>所用公式</h4><ol>
<li>拟合函数<br><img src="http://upload-images.jianshu.io/upload_images/2607041-5bbd63ec0323fae1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li>
<li>cost function<br><img src="http://upload-images.jianshu.io/upload_images/2607041-541cab8bcef0a1e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li>
<li>更新参数<br><img src="http://upload-images.jianshu.io/upload_images/2607041-39fa530ee4e63413.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li>
<li>偏导计算<br><img src="http://upload-images.jianshu.io/upload_images/2607041-b00fcbb1d3425fa0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li>
</ol>
<h4 id="梯度下降"><a href="#梯度下降" class="headerlink" title="梯度下降"></a>梯度下降</h4><p>如何使用梯度下降获得目标函数：</p>
<ol>
<li>首先我们的目标就是使得函数预测的值和真实值的误差最小。</li>
<li>为了达成这个目标我们总是依据当前的情况去判断下一步的情况。</li>
<li>使用某个变量的偏导数来判断该变量下一步变化的方向。</li>
<li>使用学习速率描述在方向上移动的快慢。</li>
<li>最终函数会逼近局部最低点，即偏导数为0的点，此时得到一个目标函数。</li>
</ol>
<h4 id="注意的问题"><a href="#注意的问题" class="headerlink" title="注意的问题"></a>注意的问题</h4><ol>
<li>学习速率的选取：过大会发散，过小会导致迭代次数太多，所以计算时尝试使用不同的学习速率，每次取值大约隔三倍。</li>
<li>特征值的范围：如果特征值之间的范围差距较大，那么可能一个特征值的大小变化会显著影响目标函数的误差，使得函数收敛的很慢。解决的方法是使用特征缩放的方式，使得特征值的范围差距不太大。</li>
</ol>
<h4 id="python模拟"><a href="#python模拟" class="headerlink" title="python模拟"></a>python模拟</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line"><span class="comment"># 随机函数</span></span><br><span class="line">def random_list(start, end, length):</span><br><span class="line">    list = []</span><br><span class="line">    for i in range(length):</span><br><span class="line">        list.append(random.uniform(start, end))</span><br><span class="line">    return list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取值范围</span></span><br><span class="line">start = 0</span><br><span class="line">end = 100</span><br><span class="line"><span class="comment"># 样本个数</span></span><br><span class="line">length = 100</span><br><span class="line"></span><br><span class="line"><span class="comment">#函数参数</span></span><br><span class="line">theta0 = 20</span><br><span class="line">theta1 = 14</span><br><span class="line">theta2 = 5</span><br><span class="line"></span><br><span class="line"><span class="comment">#自变量</span></span><br><span class="line">x = np.array(random_list(start, end, length))</span><br><span class="line">y = np.array(random_list(start, end, length))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 函数值</span></span><br><span class="line">z = int(theta0) + int(theta1) * x + int(theta2) * y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加入的误差</span></span><br><span class="line">s = np.array(random_list(-10, 10, length))</span><br><span class="line"></span><br><span class="line"><span class="comment">#真实值 = 函数值 + 误差</span></span><br><span class="line">zz = z + s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环次数</span></span><br><span class="line">loop_time = 10000</span><br><span class="line"></span><br><span class="line"><span class="comment">#允许误差</span></span><br><span class="line">epsilon = 3000</span><br><span class="line"></span><br><span class="line"><span class="comment">#学习速率</span></span><br><span class="line">alpha = 0.0001</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算的参数</span></span><br><span class="line">ctheta0 = 0</span><br><span class="line">ctheta1 = 0</span><br><span class="line">ctheta2 = 0</span><br><span class="line">count = 0</span><br><span class="line">m = len(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def h(x, y):</span><br><span class="line">    return ctheta0 + ctheta1 * x + ctheta2 * y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">diff = np.array([0, 0, 0])</span><br><span class="line"></span><br><span class="line">while count &lt; loop_time:</span><br><span class="line">    count += 1</span><br><span class="line"> for i in range(m):</span><br><span class="line">        diff[0] += (h(x[i], y[i]) - zz[i])          <span class="comment"># 偏导数和</span></span><br><span class="line"> diff[1] += (h(x[i], y[i]) - zz[i]) * x[i]</span><br><span class="line">        diff[2] += (h(x[i], y[i]) - zz[i]) * y[i]</span><br><span class="line">    ctheta0 -= alpha * diff[0] / m  <span class="comment"># 更新特征值</span></span><br><span class="line"> ctheta1 -= alpha * diff[1] / m</span><br><span class="line">    ctheta2 -= alpha * diff[2] / m</span><br><span class="line"></span><br><span class="line">    err = 0</span><br><span class="line"> for i in range(m):</span><br><span class="line">        err += (h(x[i], y[i]) - zz[i]) ** 2 <span class="comment"># 计算error</span></span><br><span class="line"> if err &lt; epsilon:</span><br><span class="line">        print(<span class="string">"theta0: %f theta1: %f theta2: %f \nctheta0: %f ctheta1: %f ctheta2: %f"</span> % (</span><br><span class="line">        theta0, theta1, theta2, ctheta0, ctheta1, ctheta2))</span><br><span class="line">        print(<span class="string">"count: %f error: %f"</span> % (count, err))</span><br><span class="line">        break;</span><br><span class="line">    diff[0] = 0</span><br><span class="line"> diff[1] = 0</span><br><span class="line"> diff[2] = 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if count &gt;= loop_time:</span><br><span class="line">    print(<span class="string">"-------loop out of time-------"</span>)</span><br><span class="line">    print(<span class="string">"theta0: %f theta1: %f theta2: %f \nctheta0: %f ctheta1: %f ctheta2: %f"</span> % (theta0, theta1, theta2, ctheta0,</span><br><span class="line">                                                                                      ctheta1, ctheta2))</span><br><span class="line">    print(<span class="string">"error: %f"</span> % err)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">loop_time</th>
<th style="text-align:center">alpha</th>
<th style="text-align:center">result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">10000</td>
<td style="text-align:center">0.0001</td>
<td style="text-align:center">ctheta0=2.02 ctheta1=14.12 ctheta2=5.18</td>
</tr>
<tr>
<td style="text-align:center">10000</td>
<td style="text-align:center">0.0003</td>
<td style="text-align:center">ctheta0=5.07 ctheta1=14.16 ctheta2=5.07</td>
</tr>
<tr>
<td style="text-align:center">100000</td>
<td style="text-align:center">0.0003</td>
<td style="text-align:center">chteta0=18.04 ctheta1=14.01 ctheta2=5.02</td>
</tr>
</tbody>
</table>
<p>一开始alpha较小时，迭代次数过多，导致迭代超过次数时ctheta0的值依然很小；随后加大alpha的值，ctheta0的值确实增加，继续增大步长会导致溢出，即发散，因此确定alpha的值为0.03。继续增加循环次数，ctheta0逐渐逼近设定值。</p>
</div><div class="tags"><a href="/tags/梯度下降/">梯度下降</a><a href="/tags/python/">python</a></div><div class="post-nav"><a class="pre" href="/2017/12/11/Stanford-coreNLP学习笔记/">Stanford coreNLP学习笔记</a><a class="next" href="/2017/10/17/秋招面经-美团-有赞/">秋招面经-美团&amp;有赞</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://localhost"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java并发/">Java并发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术杂文/">技术杂文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活总结/">生活总结</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机网络/">计算机网络</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/token/" style="font-size: 15px;">token</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/JSON/" style="font-size: 15px;">JSON</a> <a href="/tags/Redis/" style="font-size: 15px;">Redis</a> <a href="/tags/SQL/" style="font-size: 15px;">SQL</a> <a href="/tags/NoSQL/" style="font-size: 15px;">NoSQL</a> <a href="/tags/Session/" style="font-size: 15px;">Session</a> <a href="/tags/Cookie/" style="font-size: 15px;">Cookie</a> <a href="/tags/volatile/" style="font-size: 15px;">volatile</a> <a href="/tags/ThreadLocal/" style="font-size: 15px;">ThreadLocal</a> <a href="/tags/中文分词/" style="font-size: 15px;">中文分词</a> <a href="/tags/NLP/" style="font-size: 15px;">NLP</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/NexT/" style="font-size: 15px;">NexT</a> <a href="/tags/梯度下降/" style="font-size: 15px;">梯度下降</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/面经/" style="font-size: 15px;">面经</a> <a href="/tags/动态代理/" style="font-size: 15px;">动态代理</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/04/29/Java8新特性-Lambda表达式和Stream/">Java8新特性:Lambda表达式和Stream</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/27/2018中期学习计划/">2018中期学习计划</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/14/MySQL5-7-JSON调研报告/">MySQL5.7 JSON调研报告</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/11/Stanford-coreNLP学习笔记/">Stanford coreNLP学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/13/机器学习-梯度下降-学习笔记/">机器学习-梯度下降 学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/17/秋招面经-美团-有赞/">秋招面经-美团&有赞</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/22/浅谈动态代理/">浅谈动态代理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/21/ThreadLocal原理及使用/">ThreadLocal原理及使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/Session、cookie、token概述/">Session、cookie、token概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/12/SQL和NoSQL/">SQL和NoSQL</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">Reveal The Essence..</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>